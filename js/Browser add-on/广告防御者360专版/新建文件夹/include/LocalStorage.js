!function(l){l.LocalStorage=new function(){"use strict";var n="yiclear_settings",o={},c=window.browser||window.chrome;function i(e){e&&l.Log.error("Error save item cause: {0}",e)}function a(r){var e=new l.vPromise;return e.then(function(e){r(null,e)},function(e){r(e)}),e}function t(e,r,t){var n=a(t);try{var o={};o[e]=r,c.storage.local.set(o,function(){c.runtime.lastError?n.reject(c.runtime.lastError):n.resolve()})}catch(e){n.reject(e)}}var u=function(e,r){o[e]=r,t(n,o,i)};return{init:function(e){if("{}"===JSON.stringify(o)){var t=a(e);!function(r,e){var t=a(e);try{c.storage.local.get(r,function(e){c.runtime.lastError?t.reject(c.runtime.lastError):t.resolve(e?e[r]:null)})}catch(e){t.reject(e)}}(n,function(e,r){e&&i(e),o=r||{},t.resolve()})}else e()},storage:function(){return o},getItem:function(e){return e in o||function(e){if(e in localStorage){var r=localStorage.getItem(e);localStorage.removeItem(e),u(e,r)}}(e),o[e]},setItem:u,removeItem:function(e){delete o[e],localStorage.removeItem(e),t(n,o,i)}}}}(vAPI);