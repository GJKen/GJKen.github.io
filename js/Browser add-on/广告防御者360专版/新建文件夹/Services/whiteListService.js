!function(h,r){h.whiteListService=function(){"use strict";var o={whiteListRule:!0,filterId:r.AntiBannerFiltersId.WHITE_LIST_FILTER_ID},t=function(){var t=h.urlFilter,i=h.userSettings;this.defaultWhiteListMode=i.isDefaultWhiteListMode(),this.whiteListFilter=new t,this.blockListFilter=new t,this.whiteListDomains=[],this.blockListDomains=[]};return t.prototype={WHITE_LIST_DOMAINS_LS_PROP:"white-list-domains",BLOCK_LIST_DOMAINS_LS_PROP:"block-list-domains",initWhiteListFilters:function(){var t,i;for(this.whiteListDomains=this._getDomainsFromLS(this.WHITE_LIST_DOMAINS_LS_PROP),this.blockListDomains=this._getDomainsFromLS(this.BLOCK_LIST_DOMAINS_LS_PROP),t=0;t<this.whiteListDomains.length;t++)(i=this._createWhiteListRule(this.whiteListDomains[t]))&&this.whiteListFilter.addRule(i);for(t=0;t<this.blockListDomains.length;t++)(i=this._createWhiteListRule(this.blockListDomains[t]))&&this.blockListFilter.addRule(i)},findWhiteListRule:function(t){var i=r.StringUtils,e=r.UrlUtils,s=r.RequestTypes;if(i.isEmpty(t))return null;var h=e.getHost(t);return this.defaultWhiteListMode?this.whiteListFilter.isFiltered(t,h,s.DOCUMENT,!1):this.blockListFilter.isFiltered(t,h,s.DOCUMENT,!1)?null:o},isDefaultMode:function(){return this.defaultWhiteListMode},changeDefaultWhiteListMode:function(t){var i=h.userSettings;this.defaultWhiteListMode=t,i.changeDefaultWhiteListMode(t)},getWhiteList:function(){return this.defaultWhiteListMode?this.whiteListDomains:this.blockListDomains},whiteListUrl:function(t){var i=r.UrlUtils.getHost(t);this.defaultWhiteListMode?this.addToWhiteList(i):this.removeFromWhiteList(i)},unWhiteListUrl:function(t){var i=r.UrlUtils.getHost(t);this.defaultWhiteListMode?this.removeFromWhiteList(i):this.addToWhiteList(i)},addToWhiteList:function(t){var i=this._createWhiteListRule(t);i&&(this.defaultWhiteListMode?this.whiteListFilter.addRule(i):this.blockListFilter.addRule(i),this._addToArray(t),this._saveToLS())},addToWhiteListArray:function(t){if(t){for(var i=[],e=0;e<t.length;e++){var s=t[e],h=this._createWhiteListRule(s);h&&(i.push(h),this.defaultWhiteListMode?this.whiteListFilter.addRule(h):this.blockListFilter.addRule(h),this._addToArray(s))}this._saveToLS()}},removeFromWhiteList:function(t){var i=this._createWhiteListRule(t);i&&(this.defaultWhiteListMode?this.whiteListFilter.removeRule(i):this.blockListFilter.removeRule(i)),this._removeFromArray(t),this._saveToLS()},clearWhiteList:function(){var t=h.urlFilter;this.defaultWhiteListMode?(this.whiteListDomains=[],this.whiteListFilter=new t):(this.blockListDomains=[],this.blockListFilter=new t),this._saveToLS()},getRules:function(){return this.whiteListFilter.getRules()},_createWhiteListRule:function(t){var i=r.StringUtils,e=h.FilterRuleBuilder,s=r.AntiBannerFiltersId;return i.isEmpty(t)?null:e.createRule("@@//"+t+"$document",s.WHITE_LIST_FILTER_ID)},_addToArray:function(t){t&&(this.defaultWhiteListMode&&this.whiteListDomains.indexOf(t)<0?this.whiteListDomains.push(t):this.blockListDomains.indexOf(t)<0&&this.blockListDomains.push(t))},_removeFromArray:function(t){var i=r.CollectionUtils;t&&(this.defaultWhiteListMode?i.removeAll(this.whiteListDomains,t):i.removeAll(this.blockListDomains,t))},_saveToLS:function(){var t=r.LocalStorage;t.setItem(this.WHITE_LIST_DOMAINS_LS_PROP,JSON.stringify(this.whiteListDomains)),t.setItem(this.BLOCK_LIST_DOMAINS_LS_PROP,JSON.stringify(this.blockListDomains))},_getDomainsFromLS:function(t){var i=r.LocalStorage,e=[];try{var s=i.getItem(t);s&&(e=JSON.parse(s))}catch(t){}return e}},new t}}(yiclearAPI,vAPI);