if(void 0===window.yiclearCommon){var yiclearCommon=window.yiclearCommon||{},browser=browser||chrome;function detectExtensionOnMessage(){return browser.runtime&&browser.runtime.onMessage?browser.runtime.onMessage:browser.extension.onMessage?browser.extension.onMessage:browser.extension.onRequest}function detectExtensionSendMessage(){return browser.runtime&&browser.runtime.sendMessage?browser.runtime.sendMessage:browser.extension.sendMessage?browser.extension.sendMessage:browser.extension.sendRequest}yiclearCommon.BaseEvent=function(e){this.eventTarget=e,this.eventListeners=[],this.specialEventListeners=[]},yiclearCommon.BaseEvent.prototype={addListener:function(e){var n=this.specifyListener(e);this.eventListeners.push(e),this.specialEventListeners.push(n);var s=Array.prototype.slice.call(arguments,1);s=this.getOptExtraInfoSpec.apply(this,s);var t=[n].concat(s||[]);this.eventTarget.addListener.apply(this.eventTarget,t)},removeListener:function(e){var n=this.eventListeners.indexOf(e);0<n&&(this.eventTarget.removeListener(this.specialEventListeners[n]),this.eventListeners.splice(n,1),this.specialEventListeners.splice(n,1))},getOptExtraInfoSpec:function(){return[]}},yiclearCommon.OnMessageEvent=function(){yiclearCommon.BaseEvent.call(this,detectExtensionOnMessage())},yiclearCommon.OnMessageEvent.prototype={__proto__:yiclearCommon.BaseEvent.prototype,specifyListener:function(t){return function(e,n,s){return"BrowserTab"in window&&n.tab&&0<=n.tab.id&&(n.tab=new BrowserTab(n.tab)),t(e,n,s)}}},yiclearCommon.SendMessageFunction=detectExtensionSendMessage()}