!function(c,d,u){c.LocalStorage.init(function(){c.LocalStorage.storage=c.LocalStorage.storage(),d.filterRulesHitCount=d.filterRulesHitCount(),d.whiteListService=d.whiteListService(),u.yiclear=function(){"use strict";var e=u.yiclearAPI||{},t=u.vAPI.ext||{},i=e.UI,r=new e.BlockService,n=new e.FramesMap(r,BrowserTabs),a=new e.YiclearApplication(n),s=new e.FilteringLog(BrowserTabs,n,i),o=new e.WebRequestService(n,r,s,a),l=new c.ContentMessageHandler;return r.init({runCallback:function(e){e.isFirstRun&&i.openInstallPage()}}),e.filterRulesHitCount.setAntiBannerService(r),l.init(o,r,n,s,a,i),l.setSendMessageToSender(function(e,t){e.tab.sendMessage(t)}),t.onMessage.addListener(function(e,t,i){var r=l.handleMessage(e,t,i),n=!0===r;return n||i(r),n}),t.tabs.onRemoved.addListener(function(e){n.removeFrame(e)}),t.tabs.onCreated.addListener(function(e){s.addTab(e),n.checkTabIncognitoMode(e)}),t.tabs.onUpdated.addListener(function(e){s.updateTab(e)}),t.tabs.onRemoved.addListener(function(e){s.removeTab(e)}),i.getAllOpenedTabs(function(e){for(var t=0;t<e.length;t++){var i=e[t];n.recordFrame(i,0,i.url,c.RequestTypes.DOCUMENT),n.checkTabIncognitoMode(i)}}),i.bindEvents(),u.setTimeout(function(){a.serviceClient.yiclearFilterUpdate(function(e){if(d.compress=e.compress,d.spread=e.spread,""!==e.FilterUpdateUrl)for(var t=r.yiclearFilters,i=0;i<t.length;i++)t[i].filterId==e.FilterId&&(r.yiclearFilters[i].subscriptionUrl=e.FilterUpdateUrl,(Number(t[i].version)<e.FilterVersion||void 0===t[i].version)&&d.userSettings.autoUpdate()&&r._autoUpdateFilterUrl(r.yiclearFilters[i],e.FilterVersion))}.bind(this))},1e4),{webRequestService:o,framesMap:n,antiBannerService:r,filteringLog:s}}()})}(vAPI,yiclearAPI,window);