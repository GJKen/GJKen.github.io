!function(c,i){"use strict";c.FramesMap=function(n,e){var t=c.PageStatistic,h=i.FilterUtils,s=i.RequestTypes,f=i.UrlUtils,a=c.whiteListService,u=new e,m=new t(this);function r(e,t){var i=u.get(e);if(i){if(t in i)return i[t];if(-1!=t)return i[0]}return null}this.recordFrame=function(e,t,i,r){var a=u.get(e),l="";if(r==s.DOCUMENT&&a){var n=a[t];n&&(l=n.url)}return a&&r!=s.DOCUMENT||u.set(e,a=Object.create(null)),a[t]={url:i,domainName:f.getDomainName(i),previousUrl:l},r==s.DOCUMENT&&(a[t].timeAdded=Date.now(),this.reloadFrameData(e)),a[t]},this.removeFrame=function(e){u.remove(e)},this.getMainFrame=function(e){return r(e,0)},this.getFrameUrl=function(e,t){var i=r(e,t);return i?i.url:null},this.getFrameDomain=function(e){var t=r(e,0);return t?t.domainName:null},this.getMainFrameUrl=function(e){var t=r(e,0);return t?t.url:null},this.isTabWhiteListed=function(e){var t=this.getMainFrame(e);return t&&t.frameWhiteListRule},this.isTabWhiteListedForSafebrowsing=function(e){var t=this.getMainFrame(e);return t&&t.frameWhiteListRule&&a.isDefaultMode()},this.isTabProtectionDisabled=function(e){var t=this.getMainFrame(e);return t&&t.applicationFilteringDisabled},this.isTabyiclearDetected=function(e){var t=this.getMainFrame(e);return t&&t.yiclearDetected},this.isTabyiclearWhiteListed=function(e){var t=this.getMainFrame(e);return t&&t.yiclearDetected&&t.yiclearDocumentWhiteListed},this.getTabyiclearUserWhiteListRule=function(e){var t=this.getMainFrame(e);return t&&t.yiclearDetected&&t.yiclearUserWhiteListed?t.yiclearWhiteListRule:null},this.recordYiclearIntegrationForTab=function(e,t,i,r,a,l,n){var s=this.getMainFrame(e);s&&(s.yiclearDetected=t,s.yiclearDocumentWhiteListed=i,s.yiclearUserWhiteListed=r,s.yiclearWhiteListRule=a,s.yiclearProductName=l,s.yiclearRemoveRuleNotSupported=n)},this.getFrameWhiteListRule=function(e){var t=this.getMainFrame(e);return t?t.frameWhiteListRule:null},this.reloadFrameData=function(e){var t=this.getMainFrame(e);if(t){var i=t.url,r=n.getRequestFilter().findWhiteListRule(i,i,s.DOCUMENT);r||(r=a.findWhiteListRule(i)),t.frameWhiteListRule=r,t.applicationFilteringDisabled=n.isApplicationFilteringDisabled()}},this.recordFrameReferrerHeader=function(e,t){var i=this.getMainFrame(e);if(i&&(i.referrerUrl=t),c.userSettings.Developer()||!c.compress){var r=i.url,a=n.getRequestFilter().findRuleForRequest(r,t,"RELOAD");if(null!=a&&null!=a.ReloadUrls){var l=r.replace(a.urlRegExp,a.ReloadUrls);e.reload(l)}}},this.getFrameInfo=function(e){var t=this.getMainFrame(e),i=e.url;!i&&t&&(i=t.url);var r,a,l=!f.isHttpRequest(i),n=!1,s=!1,u=!1;if(!l)if(t&&t.yiclearDetected)n=t.yiclearDocumentWhiteListed,s=t.yiclearUserWhiteListed,u=!(t.yiclearRemoveRuleNotSupported||n&&!s),r=!1,t.yiclearWhiteListRule&&(a={filterId:AntiBannerFiltersId.WHITE_LIST_FILTER_ID,ruleText:t.yiclearWhiteListRule.ruleText});else{r=t&&t.applicationFilteringDisabled;var c=t?t.frameWhiteListRule:null;(n=null!=c)&&(s=h.isWhiteListFilterRule(c)||h.isUserFilterRule(c)),u=!(n&&!s),c&&(a={filterId:c.filterId,ruleText:c.ruleText})}var o=t?t.blocked:0,d=m.getTotalBlocked();return{url:i,applicationFilteringDisabled:r,urlFilteringDisabled:l,documentWhiteListed:n,userWhiteListed:s,canAddRemoveRule:u,frameRule:a,yiclearDetected:t&&t.yiclearDetected,yiclearProductName:t?t.yiclearProductName:null,totalBlockedTab:o||0,totalBlocked:d||0}},this.updateBlockedAdsCount=function(e,t){var i=this.getMainFrame(e);return i?(i.blocked=(i.blocked||0)+t,m.updateTotalBlocked(t),i.blocked):null},this.resetBlockedAdsCount=function(e){if(e){var t=this.getMainFrame(e);t&&(t.blocked=0)}else m.resetStats()},this.getBlockedCount=function(){return m.getTotalBlocked()},this.checkTabIncognitoMode=function(e){u.checkIncognitoMode(e)},this.isIncognitoTab=function(e){return u.isIncognito(e)}}}(yiclearAPI,vAPI);